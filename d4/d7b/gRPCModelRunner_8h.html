<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MLCompilerBridge: include/MLModelRunner/gRPCModelRunner.h File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">MLCompilerBridge
   </div>
   <div id="projectbrief">Tools for streamlining communication with ML models for compiler optimizations.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="../../dir_20bfb6810f9215af3b085f0b6b86aa7b.html">MLModelRunner</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#namespaces">Namespaces</a>  </div>
  <div class="headertitle"><div class="title">gRPCModelRunner.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>gRPCModelRunner class supporting communication via gRPC.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="../../df/d23/MLModelRunner_8h_source.html">MLModelRunner/MLModelRunner.h</a>&quot;</code><br />
<code>#include &lt;future&gt;</code><br />
<code>#include &lt;google/protobuf/text_format.h&gt;</code><br />
<code>#include &lt;grpcpp/grpcpp.h&gt;</code><br />
<code>#include &lt;grpcpp/health_check_service_interface.h&gt;</code><br />
<code>#include &lt;memory&gt;</code><br />
<code>#include &lt;thread&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for gRPCModelRunner.h:</div>
<div class="dyncontent">
<div class="center"><img src="../../d5/d26/gRPCModelRunner_8h__incl.png" border="0" usemap="#ainclude_2MLModelRunner_2gRPCModelRunner_8h" alt=""/></div>
<map name="ainclude_2MLModelRunner_2gRPCModelRunner_8h" id="ainclude_2MLModelRunner_2gRPCModelRunner_8h">
<area shape="rect" title="gRPCModelRunner class supporting communication via gRPC." alt="" coords="962,5,1123,46"/>
<area shape="rect" href="../../df/d23/MLModelRunner_8h.html" title="The MLModelRunner class is the main interface for interacting with the ML models." alt="" coords="444,102,670,127"/>
<area shape="poly" title=" " alt="" coords="961,44,641,101,640,96,960,39"/>
<area shape="rect" title=" " alt="" coords="586,256,653,282"/>
<area shape="poly" title=" " alt="" coords="1014,49,988,70,964,96,949,127,943,155,935,183,927,197,913,210,895,221,869,231,804,247,669,266,668,261,803,241,868,226,892,216,910,206,923,194,931,181,938,154,944,125,960,92,985,66,1011,45"/>
<area shape="rect" title=" " alt="" coords="846,183,900,208"/>
<area shape="poly" title=" " alt="" coords="990,49,953,69,920,96,897,132,882,169,877,167,892,129,916,92,950,64,988,44"/>
<area shape="rect" title=" " alt="" coords="975,94,1110,135"/>
<area shape="poly" title=" " alt="" coords="1045,47,1045,78,1040,78,1040,47"/>
<area shape="rect" title=" " alt="" coords="1134,102,1247,127"/>
<area shape="poly" title=" " alt="" coords="1077,44,1158,91,1155,96,1074,49"/>
<area shape="rect" title=" " alt="" coords="1272,94,1413,135"/>
<area shape="poly" title=" " alt="" coords="1111,44,1261,87,1259,92,1110,49"/>
<area shape="rect" title=" " alt="" coords="1438,102,1495,127"/>
<area shape="poly" title=" " alt="" coords="1124,32,1266,54,1347,70,1426,91,1430,93,1428,98,1424,97,1345,75,1265,59,1123,38"/>
<area shape="rect" href="../../d2/d15/baseSerDes_8h.html" title="Supporting new SerDes:" alt="" coords="124,256,273,282"/>
<area shape="poly" title=" " alt="" coords="444,125,322,134,194,147,88,164,53,174,35,185,28,196,27,206,32,215,41,223,72,238,110,250,109,255,70,243,38,228,28,218,22,207,23,194,31,181,51,169,87,159,193,142,322,129,444,120"/>
<area shape="rect" title=" " alt="" coords="228,330,281,356"/>
<area shape="poly" title=" " alt="" coords="444,125,319,134,186,147,77,164,41,174,21,185,13,197,9,209,9,221,13,232,32,254,62,274,99,292,139,307,213,329,212,334,137,312,97,297,59,279,29,258,9,235,4,222,3,209,8,195,18,181,39,169,76,159,186,141,318,128,444,119"/>
<area shape="rect" href="../../d6/d32/bitstreamSerDes_8h.html" title="Bitstream Serialization/Deserialization which sends header information followed by the raw data." alt="" coords="407,183,582,208"/>
<area shape="poly" title=" " alt="" coords="549,129,515,172,511,169,545,126"/>
<area shape="poly" title=" " alt="" coords="567,126,597,182,616,241,611,242,592,184,562,129"/>
<area shape="rect" href="../../d2/dd2/jsonSerDes_8h.html" title="Json Serialization/Deserialization using LLVM&#39;s json library." alt="" coords="238,183,383,208"/>
<area shape="poly" title=" " alt="" coords="520,130,363,180,362,175,518,125"/>
<area shape="rect" title=" " alt="" coords="657,183,716,208"/>
<area shape="poly" title=" " alt="" coords="578,125,655,172,652,177,575,130"/>
<area shape="poly" title=" " alt="" coords="611,125,831,179,830,184,610,130"/>
<area shape="rect" title=" " alt="" coords="740,183,822,208"/>
<area shape="poly" title=" " alt="" coords="592,125,733,175,731,180,590,130"/>
<area shape="rect" href="../../d1/de8/protobufSerDes_8h.html" title="Protobuf Serialization/Deserialization to support gRPC communication." alt="" coords="45,183,213,208"/>
<area shape="poly" title=" " alt="" coords="491,130,210,182,209,177,490,125"/>
<area shape="poly" title=" " alt="" coords="210,281,237,316,233,319,205,284"/>
<area shape="poly" title=" " alt="" coords="444,212,264,255,263,250,443,206"/>
<area shape="poly" title=" " alt="" coords="475,211,289,324,286,319,473,207"/>
<area shape="poly" title=" " alt="" coords="517,207,586,246,584,251,514,211"/>
<area shape="poly" title=" " alt="" coords="293,211,231,250,229,245,290,207"/>
<area shape="poly" title=" " alt="" coords="310,209,287,283,271,317,266,315,282,281,305,208"/>
<area shape="poly" title=" " alt="" coords="142,207,178,243,174,247,138,210"/>
</map>
</div>
</div>
<p><a href="../../d4/d7b/gRPCModelRunner_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d4a/classMLBridge_1_1gRPCModelRunner.html">MLBridge::gRPCModelRunner&lt; Client, Stub, Request, Response &gt;</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">This class is used to create the grpc model runner object.  <a href="../../d4/d4a/classMLBridge_1_1gRPCModelRunner.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="namespaces" name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:d5/d9c/namespaceMLBridge" id="r_d5/d9c/namespaceMLBridge"><td class="memItemLeft" align="right" valign="top">namespace &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/d9c/namespaceMLBridge.html">MLBridge</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>gRPCModelRunner class supporting communication via gRPC. </p>
<p>This class is used to communicate with the gRPC server and send/receive data to/from the model. Supports interleaved communication with the model.</p>
<p>There are two ways to use this class:</p><ol type="1">
<li>Training mode - gRPC Server: In this mode, the gRPCModelRunner object is created with the server address and the service object. The service object is used to create the server and the server waits for the client to connect. Once the client connects, the server waits for the client to send the request and then responds with the result. In Training mode, GrpcCompilerInterface class from <a class="el" href="../../d1/d5a/GrpcCompilerInterface_8py.html" title="Compiler interface for gRPC.">GrpcCompilerInterface.py</a> acts as the client and sends the request to the server.</li>
<li>Inference mode - gRPC Client: In this mode, the gRPCModelRunner object is created with the server address, request and response objects. The request object is used to send the features to the model and the response object is used to receive the result from the model.</li>
</ol>
<p>In Inference mode, the compiler pass using this class acts as the client and sends the request to the server implemented by using <a class="el" href="../../d1/d5a/GrpcCompilerInterface_8py.html" title="Compiler interface for gRPC.">GrpcCompilerInterface.py</a>.</p>
<p>Interfacing with the model using protobuf (.proto) files: Users should define the service, stub, request and response by writing a .proto file. The service and stub objects are generated using the protoc compiler. The request and response objects are generated using the protoc compiler or created by the user. The build process will automatically compile .proto files and generates the relevant stubs and request/response objects in both CPP and Python which will be used by gRPCModelRunner and GrpcCompilerInterface respectively..</p>
<p>In Inference mode, users should override <code>getAdvice()</code> RPC method in the Python model code to process the request and send the response back to the client. This method is called by the gRPC server in the evaluate_untyped() method of gRPCModelRunner class to get the result from the model after populating the features in the request object.</p>
<p>In Training mode, users should override the RPC function/service that they declare in the .proto file in the Compiler pass which is using the gRPCModelRunner. This function is called by the gRPC client (Python model) that is using the GrpcCompilerInterface class to send the request to the server.</p>
<p>Usage:</p><ol type="1">
<li>Create a .proto file with the service and message definitions</li>
<li>Generate the stubs using protoc</li>
<li>Create a gRPCModelRunner object with the server address, stub, request and response</li>
<li>Populate the features to be sent to the model</li>
<li>Call <a class="el" href="../../d0/d16/C_2ONNXModelRunner_8h.html#a01a4936796df6ca38ab4c976abed0124">evaluate()</a> to get the result back from the model </li>
</ol>

<p class="definition">Definition in file <a class="el" href="../../d4/d7b/gRPCModelRunner_8h_source.html">gRPCModelRunner.h</a>.</p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
